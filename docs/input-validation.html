<html><head><title>finatra common practice</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="docs" /><meta name="description" content="Guideline for common practice in finatra 2.11" /><meta name="og:image" content="/finatra-common-practice/img/poster.png" /><meta name="og:title" content="finatra common practice" /><meta name="og:site_name" content="finatra common practice" /><meta name="og:url" content="" /><meta name="og:type" content="website" /><meta name="og:description" content="Guideline for common practice in finatra 2.11" /><link rel="icon" type="image/png" href="/finatra-common-practice/img/favicon.png" /><meta name="twitter:title" content="finatra common practice" /><meta name="twitter:image" content="img/poster.png" /><meta name="twitter:description" content="Guideline for common practice in finatra 2.11" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/finatra-common-practice/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/finatra-common-practice/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/finatra-common-practice/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/finatra-common-practice/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/finatra-common-practice/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/finatra-common-practice/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/finatra-common-practice/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/finatra-common-practice/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/finatra-common-practice/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/finatra-common-practice/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/finatra-common-practice/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/finatra-common-practice/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/finatra-common-practice/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/finatra-common-practice/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/finatra-common-practice/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/finatra-common-practice/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/finatra-common-practice/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/finatra-common-practice/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/finatra-common-practice/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/finatra-common-practice/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/finatra-common-practice/highlight/styles/github.css" /><link rel="stylesheet" href="/finatra-common-practice/css/style.css" /><link rel="stylesheet" href="/finatra-common-practice/css/palette.css" /><link rel="stylesheet" href="/finatra-common-practice/css/codemirror.css" /><link rel="stylesheet" href="/finatra-common-practice/css/kazari-style.css" /><link rel="stylesheet" href="/finatra-common-practice/css/monokai.css" /><link rel="stylesheet" href="/finatra-common-practice/css/override.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/finatra-common-practice/" class="brand"><div class="brand-wrapper"><span>finatra common practice</span></div></a></li> <li><a href="/finatra-common-practice/docs/index.html" class="">Introduction</a></li> <li><a href="/finatra-common-practice/docs/pipe-operator.html" class="">Pipe Operator</a></li> <li><a href="/finatra-common-practice/docs/input-validation.html" class=" active ">Input Validation</a></li> <li><a href="/finatra-common-practice/docs/http-client.html" class="">Http Client</a></li> <li><a href="/finatra-common-practice/docs/errors-and-http-response.html" class="">Errors and Http Response</a></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li id="gh-eyes-item" class="hidden-xs"><a href="https://github.com/jamesyang124/finatra-common-practice"><i class="fa fa-eye"></i><span>WATCH<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs"><a href="https://github.com/jamesyang124/finatra-common-practice"><i class="fa fa-star-o"></i><span>STARS<span id="stars" class="label label-default">--</span></span></a></li><li><a href="#" onclick="shareSiteTwitter('finatra common practice Guideline for common practice in finatra 2.11');"><i class="fa fa-twitter"></i></a></li><li><a href="#" onclick="shareSiteFacebook('finatra common practice Guideline for common practice in finatra 2.11');"><i class="fa fa-facebook"></i></a></li><li><a href="#" onclick="shareSiteGoogle();"><i class="fa fa-google-plus"></i></a></li></ul></div></div></div></div><div id="content" data-github-owner="jamesyang124" data-github-repo="finatra-common-practice"><div class="content-wrapper"><section><h1 id="input-validation">Input Validation</h1>

<p>Same type of input validation can be reused by hand-crafted annotation interface or finatra’s <code class="highlighter-rouge">MethodValidation</code> annotation. Though the first approach is more succinct in case class declaration, but the validation logic will not directly present in its declaration. Instead, We suggest to use finatra’s <code class="highlighter-rouge">MethodValidation</code> helpers for readability.</p>

<h3 id="customized-annotation-interface">Customized Annotation Interface</h3>

<p>Define annotation interface first:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="c1">// EmailFormatInternal.java
</span><span class="k">import</span> <span class="nn">com.twitter.finatra.validation.Validation</span><span class="o">;</span>

<span class="k">import</span> <span class="nn">java.lang.annotation.Retention</span><span class="o">;</span>
<span class="k">import</span> <span class="nn">java.lang.annotation.Target</span><span class="o">;</span>

<span class="k">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">annotation</span><span class="o">.</span><span class="nc">ElementType</span><span class="o">.</span><span class="nc">PARAMETER</span><span class="o">;</span>
<span class="k">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">annotation</span><span class="o">.</span><span class="nc">RetentionPolicy</span><span class="o">.</span><span class="nc">RUNTIME</span><span class="o">;</span>

<span class="nd">@Target</span><span class="o">({</span> <span class="nc">PARAMETER</span> <span class="o">})</span>
<span class="nd">@Retention</span><span class="o">(</span><span class="nc">RUNTIME</span><span class="o">)</span>
<span class="nd">@Validation</span><span class="o">(</span><span class="n">validatedBy</span> <span class="k">=</span> <span class="nc">EmailFormatValidator</span><span class="o">.</span><span class="n">class</span><span class="o">)</span>
<span class="n">public</span> <span class="nd">@interface</span> <span class="nc">EmailFormatInternal</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre>
</div>

<p>Once the annotation interface is defined, supply the validator such as <code class="highlighter-rouge">EmailFormatValidator</code>:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">import</span> <span class="nn">java.util.regex.Pattern</span>
<span class="k">import</span> <span class="nn">com.twitter.finatra.validation.</span><span class="o">{</span><span class="nc">ValidationMessageResolver</span><span class="o">,</span> <span class="nc">ValidationResult</span><span class="o">,</span> <span class="nc">Validator</span><span class="o">}</span>

<span class="k">class</span> <span class="nc">EmailFormatValidator</span><span class="o">(</span><span class="n">validationMessageResolver</span><span class="k">:</span> <span class="kt">ValidationMessageResolver</span><span class="o">,</span>
                                         <span class="n">annotation</span><span class="k">:</span> <span class="kt">EmailFormatInternal</span><span class="o">)</span>
    <span class="k">extends</span> <span class="nc">Validator</span><span class="o">[</span><span class="kt">EmailFormatInternal</span>, <span class="kt">Any</span><span class="o">](</span><span class="n">validationMessageResolver</span><span class="o">,</span> <span class="n">annotation</span><span class="o">)</span> <span class="o">{</span>

  <span class="k">override</span> <span class="k">def</span> <span class="n">isValid</span><span class="o">(</span><span class="n">value</span><span class="k">:</span> <span class="kt">Any</span><span class="o">)</span><span class="k">:</span> <span class="kt">ValidationResult</span> <span class="o">=</span> <span class="o">{</span>
    <span class="n">value</span> <span class="k">match</span> <span class="o">{</span>
      <span class="k">case</span> <span class="nc">Some</span><span class="o">(</span><span class="n">e</span><span class="k">:</span> <span class="kt">EmailAddress</span><span class="o">)</span> <span class="k">=&gt;</span>
        <span class="n">validationResult</span><span class="o">(</span><span class="n">e</span><span class="o">)</span>
      <span class="k">case</span> <span class="n">emailValue</span><span class="k">:</span> <span class="kt">EmailAddress</span> <span class="o">=&gt;</span>
        <span class="n">validationResult</span><span class="o">(</span><span class="n">emailValue</span><span class="o">)</span>
      <span class="k">case</span> <span class="nc">None</span>      <span class="k">=&gt;</span> <span class="nc">ValidationResult</span><span class="o">.</span><span class="n">validate</span><span class="o">(</span><span class="kc">true</span><span class="o">,</span> <span class="s">""</span><span class="o">)</span>
      <span class="k">case</span> <span class="n">s</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=&gt;</span> <span class="n">validationResult</span><span class="o">(</span><span class="nc">EmailAddress</span><span class="o">(</span><span class="n">s</span><span class="o">))</span>
      <span class="k">case</span> <span class="k">_</span> <span class="k">=&gt;</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nc">IllegalArgumentException</span><span class="o">(</span><span class="n">s</span><span class="s">"Class [${value.getClass}}] is not supported"</span><span class="o">)</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="k">private</span> <span class="k">def</span> <span class="n">validationResult</span><span class="o">(</span><span class="n">value</span><span class="k">:</span> <span class="kt">EmailAddress</span><span class="o">)</span> <span class="k">=</span> <span class="o">{</span>
    <span class="nc">ValidationResult</span><span class="o">.</span><span class="n">validate</span><span class="o">(</span><span class="n">validate</span><span class="o">(</span><span class="n">value</span><span class="o">),</span> <span class="n">s</span><span class="s">"Invalid email format, email:${value.email}"</span><span class="o">)</span>
  <span class="o">}</span>

  <span class="k">private</span> <span class="k">def</span> <span class="n">validate</span><span class="o">(</span><span class="n">email</span><span class="k">:</span> <span class="kt">com.htc.cs.account.domain.account.EmailAddress</span><span class="o">)</span><span class="k">:</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">pattern</span><span class="k">:</span> <span class="kt">Pattern</span> <span class="o">=</span> <span class="nc">Pattern</span><span class="o">.</span><span class="n">compile</span><span class="o">(</span>
      <span class="s">"""^((([a-z]|\d|[!#\$%&amp;'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&amp;'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$"""</span><span class="o">,</span>
      <span class="nc">Pattern</span><span class="o">.</span><span class="nc">CASE_INSENSITIVE</span>
    <span class="o">)</span>

    <span class="n">pattern</span><span class="o">.</span><span class="n">matcher</span><span class="o">(</span><span class="n">email</span><span class="o">.</span><span class="n">email</span><span class="o">).</span><span class="n">find</span><span class="o">()</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<p>The <code class="highlighter-rouge">ValidationMessageResolver</code>, <code class="highlighter-rouge">ValidationResult</code>, <code class="highlighter-rouge">Validator</code> are necessary for creating customized annotation, but the validation logic simply locate at <code class="highlighter-rouge">validate</code> private method. Also, <code class="highlighter-rouge">isValid</code> method is required to be overriden.</p>

<p>Finally, define a type alias as annotation format:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">import</span> <span class="nn">scala.annotation.meta.param</span>

<span class="k">package</span> <span class="nn">object</span> <span class="n">validation</span> <span class="o">{</span>
  <span class="k">type</span> <span class="kt">EmailFormat</span>        <span class="o">=</span> <span class="nc">EmailFormatInternal</span> <span class="nd">@param</span>
<span class="o">}</span>
</code></pre>
</div>

<p>Then prefix it in the field of case class declaration by <code class="highlighter-rouge">EmailFormat</code> type alias:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">import</span> <span class="nn">com.twitter.finatra.request.Header</span>
<span class="k">import</span> <span class="nn">com.twitter.finatra.validation.NotEmpty</span>

<span class="k">case</span> <span class="k">class</span> <span class="nc">ChangeEmailRequest</span><span class="o">(</span><span class="nd">@EmailFormat</span>      <span class="n">email</span><span class="k">:</span> <span class="kt">EmailAddress</span><span class="o">,</span>
                              <span class="nd">@NotEmpty</span> <span class="nd">@Header</span> <span class="n">token</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span>
</code></pre>
</div>

<h3 id="methodvalidation">MethodValidation</h3>

<p>Finatra’s <code class="highlighter-rouge">@MethodValidation</code> annotate a customized method definition in case class declaration body.</p>

<blockquote>
  <p>A method validation is a case class method annotated with <code class="highlighter-rouge">@MethodValidation</code> which is intended to be used for validating fields of the cases class during request parsing.</p>
</blockquote>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="k">class</span> <span class="nc">InvalidInputAccountIdError</span> <span class="k">extends</span> <span class="nc">SimpleError</span><span class="o">(</span><span class="s">"Invalid input account id format"</span><span class="o">)</span>

<span class="k">case</span> <span class="k">class</span> <span class="nc">InputAccountId</span><span class="o">(</span><span class="nd">@NotEmpty</span> <span class="n">value</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">WrappedValue</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="o">{</span>
  <span class="nd">@MethodValidation</span>
  <span class="k">def</span> <span class="n">validatePasswordInput</span><span class="k">:</span> <span class="kt">ValidationResult</span> <span class="o">=</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">res</span> <span class="k">=</span> <span class="nc">Try</span><span class="o">(</span><span class="nc">UUID</span><span class="o">.</span><span class="n">fromString</span><span class="o">(</span><span class="n">value</span><span class="o">)).</span><span class="n">isReturn</span>

    <span class="nc">ValidationResult</span><span class="o">.</span><span class="n">validate</span><span class="o">(</span><span class="n">res</span><span class="o">,</span> <span class="nc">InvalidInputAccountIdError</span><span class="o">.</span><span class="n">represent</span><span class="o">(</span><span class="kc">true</span><span class="o">))</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h3 id="conclusion">Conclusion</h3>

<p>Define validation logic for the case class request, also define validation logic in each field of it. For the input request, build validation types to guard the value of each input. Leverage Finatra predefined annotation such as <code class="highlighter-rouge">@NotEmpty</code>, <code class="highlighter-rouge">@Range</code>, etc for DRY principle.</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="k">class</span> <span class="nc">EmailAccountRequest</span><span class="o">(</span><span class="n">email</span><span class="k">:</span> <span class="kt">InputEmail</span><span class="o">,</span>
                               <span class="n">languageCode</span><span class="k">:</span> <span class="kt">InputLanguageCode</span><span class="o">,</span>
                               <span class="nd">@NotEmpty</span> <span class="n">firstName</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span>
                               <span class="nd">@NotEmpty</span> <span class="n">lastName</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span>
</code></pre>
</div>

<h3 id="examples">Examples</h3>

<h4 id="account-id">Account Id</h4>

<p><em>Account Id</em> is validated by <code class="highlighter-rouge">java.util.UUID#fromString</code> method.</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="k">class</span> <span class="nc">InputAccountId</span><span class="o">(</span><span class="nd">@NotEmpty</span> <span class="n">value</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">WrappedValue</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="o">{</span>
  <span class="nd">@MethodValidation</span>
  <span class="k">def</span> <span class="n">validatePasswordInput</span><span class="k">:</span> <span class="kt">ValidationResult</span> <span class="o">=</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">res</span> <span class="k">=</span> <span class="nc">Try</span><span class="o">(</span><span class="nc">UUID</span><span class="o">.</span><span class="n">fromString</span><span class="o">(</span><span class="n">value</span><span class="o">)).</span><span class="n">isReturn</span>

    <span class="nc">ValidationResult</span><span class="o">.</span><span class="n">validate</span><span class="o">(</span><span class="n">res</span><span class="o">,</span> <span class="nc">InvalidInputAccountIdError</span><span class="o">.</span><span class="n">represent</span><span class="o">(</span><span class="kc">true</span><span class="o">))</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="email">Email</h4>

<p><em>Email</em> format follow <em>RFC 5322</em> standard and support unicode pattern.</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="k">class</span> <span class="nc">InputEmail</span><span class="o">(</span><span class="nd">@NotEmpty</span> <span class="n">value</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">WrappedValue</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="o">{</span>
  <span class="nd">@MethodValidation</span>
  <span class="k">def</span> <span class="n">validatePasswordInput</span><span class="k">:</span> <span class="kt">ValidationResult</span> <span class="o">=</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">pattern</span> <span class="k">=</span>
      <span class="s">"""^((([a-z]|\d|[!#\$%&amp;'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&amp;'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$"""</span>

    <span class="nc">ValidationResult</span><span class="o">.</span><span class="n">validate</span><span class="o">(</span><span class="n">value</span><span class="o">.</span><span class="n">matches</span><span class="o">(</span><span class="n">pattern</span><span class="o">),</span> <span class="nc">InvalidInputEmailError</span><span class="o">.</span><span class="n">represent</span><span class="o">(</span><span class="kc">true</span><span class="o">))</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="phone">Phone</h4>

<p><em>Phone</em> is validated by goole phone number library - <a href="https://github.com/googlei18n/libphonenumber">https://github.com/googlei18n/libphonenumber</a></p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="k">class</span> <span class="nc">InputPhone</span><span class="o">(</span><span class="n">value</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">countryCode</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="o">{</span>

  <span class="nd">@MethodValidation</span>
  <span class="k">def</span> <span class="n">validateInputPhone</span><span class="k">:</span> <span class="kt">ValidationResult</span> <span class="o">=</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">res</span> <span class="k">=</span> <span class="k">for</span> <span class="o">{</span>
      <span class="n">p</span> <span class="k">&lt;-</span> <span class="nc">PhoneUtils</span><span class="o">.</span><span class="n">parse</span><span class="o">(</span><span class="n">value</span><span class="o">,</span> <span class="n">countryCode</span><span class="o">)</span>
      <span class="k">_</span> <span class="k">&lt;-</span> <span class="nc">PhoneUtils</span><span class="o">.</span><span class="n">checkPhoneNumber</span><span class="o">(</span><span class="n">p</span><span class="o">,</span> <span class="n">countryCode</span><span class="o">)</span>
    <span class="o">}</span> <span class="k">yield</span> <span class="kc">true</span>

    <span class="nc">ValidationResult</span><span class="o">.</span><span class="n">validate</span><span class="o">(</span><span class="n">res</span><span class="o">.</span><span class="n">isRight</span><span class="o">,</span> <span class="nc">InvalidInputPhoneError</span><span class="o">.</span><span class="n">represent</span><span class="o">(</span><span class="kc">true</span><span class="o">))</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="language-code">Language Code</h4>

<p><em>Language code</em> is one of the value from <code class="highlighter-rouge">Locale.getAvailableLocales</code> list.</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="k">class</span> <span class="nc">InputLanguageCode</span><span class="o">(</span><span class="nd">@NotEmpty</span> <span class="n">value</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">WrappedValue</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="o">{</span>
  <span class="nd">@MethodValidation</span>
  <span class="k">def</span> <span class="n">validateLanguageCode</span><span class="k">:</span> <span class="kt">ValidationResult</span> <span class="o">=</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">locales</span><span class="k">:</span> <span class="kt">Seq</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Locale</span><span class="o">.</span><span class="n">getAvailableLocales</span><span class="o">.</span><span class="n">toList</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">toString</span><span class="o">.</span><span class="n">replace</span><span class="o">(</span><span class="s">"_"</span><span class="o">,</span> <span class="s">"-"</span><span class="o">))</span>
    <span class="k">val</span> <span class="n">res</span>                  <span class="k">=</span> <span class="n">value</span><span class="o">.</span><span class="n">length</span> <span class="o">!=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">locales</span><span class="o">.</span><span class="n">contains</span><span class="o">(</span><span class="n">value</span><span class="o">)</span>

    <span class="nc">ValidationResult</span><span class="o">.</span><span class="n">validate</span><span class="o">(</span><span class="n">res</span><span class="o">,</span> <span class="nc">InvalidInputLanguageCodeError</span><span class="o">.</span><span class="n">represent</span><span class="o">(</span><span class="kc">true</span><span class="o">))</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="password">Password</h4>

<p><em>Password</em> input format require at least 1 upper case, 1 lower case, 1 numerical digit, and the input length is greater than or equal to 8.</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="k">class</span> <span class="nc">InputPassword</span><span class="o">(</span><span class="nd">@NotEmpty</span> <span class="n">value</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">WrappedValue</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="o">{</span>

  <span class="nd">@MethodValidation</span>
  <span class="k">def</span> <span class="n">validatePasswordInput</span><span class="k">:</span> <span class="kt">ValidationResult</span> <span class="o">=</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">pattern</span>                 <span class="k">=</span> <span class="s">"""(?=.*[a-z])(?=.*[A-Z])(?=.*[\d]).{8,}"""</span>
    <span class="k">val</span> <span class="n">validate</span><span class="k">:</span> <span class="o">()</span> <span class="o">=&gt;</span> <span class="nc">Boolean</span> <span class="k">=</span> <span class="o">()</span> <span class="k">=&gt;</span> <span class="n">value</span><span class="o">.</span><span class="n">matches</span><span class="o">(</span><span class="n">pattern</span><span class="o">)</span>

    <span class="nc">ValidationResult</span><span class="o">.</span><span class="n">validate</span><span class="o">(</span><span class="n">validate</span><span class="o">(),</span> <span class="nc">InvalidInputPasswordError</span><span class="o">.</span><span class="n">represent</span><span class="o">(</span><span class="kc">true</span><span class="o">))</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>
</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/finatra-common-practice/highlight/highlight.pack.js"></script><script>hljs.configure({
languages:['scala','java','bash']
});
hljs.initHighlighting();
             </script><script src="/finatra-common-practice/js/main.js"></script><script src="/finatra-common-practice/js/kazari.js"></script><script>
$(document).ready(function() {
	kazari.KazariPlugin().decorateCode('https://scala-evaluator-212.herokuapp.com/eval', 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.S2F6YXJp.Jl2eqMfw8IakJF93PjxTbrf-8YUJgX5OoOfy5JHE8Yw', '', 'monokai')
})
    </script></body></html>